#%RAML 1.0
title: Purchase Order Process API
version: v1
baseUri: http://localhost:8083/api/v1

documentation:
  - title: Purchase Order Process API
    content: |
      This Process API provides common orchestration layer for purchase order integrations.
      It transforms source order schemas (Flipkart/Amazon) into target formats (IBM/HP).
      It follows the Process API layer pattern in MuleSoft's three-layer architecture.

types:
  ProcessOrderRequest:
    type: object
    properties:
      source:
        type: string
        enum: [FLIPKART, AMAZON]
        required: true
        example: "FLIPKART"
        description: Source system identifier
      target:
        type: string
        enum: [IBM, HP]
        required: true
        example: "IBM"
        description: Target system identifier
      orderId:
        type: string
        required: true
        example: "FK123456789"
        description: Order ID from the source system
      orderData:
        type: object
        required: true
        description: Raw order data from source system

  IBMOrderFormat:
    type: object
    properties:
      ibm_order_id:
        type: string
        required: true
        example: "IBM_FK123456789"
      client_details:
        type: object
        properties:
          client_id:
            type: string
            required: true
            example: "CUST001"
          client_name:
            type: string
            required: true
            example: "John Doe"
          contact_email:
            type: string
            required: true
            example: "john.doe@email.com"
          contact_phone:
            type: string
            required: true
            example: "+91-9876543210"
      order_summary:
        type: object
        properties:
          created_date:
            type: datetime
            required: true
            example: "2024-01-15T10:30:00.000Z"
          total_value:
            type: number
            required: true
            example: 45000.00
          currency_type:
            type: string
            required: true
            example: "INR"
          processing_status:
            type: string
            enum: [NEW, IN_PROGRESS, COMPLETED, FAILED, CANCELLED]
            required: true
            example: "NEW"
      line_items:
        type: array
        items:
          type: object
          properties:
            line_id:
              type: string
              required: true
              example: "LINE_001"
            product_code:
              type: string
              required: true
              example: "ITEM001"
            product_description:
              type: string
              required: true
              example: "Laptop Dell Inspiron"
            order_quantity:
              type: integer
              required: true
              example: 1
            unit_cost:
              type: number
              required: true
              example: 45000.00
            item_category:
              type: string
              required: true
              example: "Electronics"
      delivery_info:
        type: object
        properties:
          address_line_1:
            type: string
            required: true
            example: "123 Main Street"
          address_line_2:
            type: string
            required: false
            example: "Apartment 4B"
          city_name:
            type: string
            required: true
            example: "Bangalore"
          state_province:
            type: string
            required: true
            example: "Karnataka"
          postal_code:
            type: string
            required: true
            example: "560001"
          country_name:
            type: string
            required: true
            example: "India"

  HPOrderFormat:
    type: object
    properties:
      hp_reference_number:
        type: string
        required: true
        example: "HP_AMZ987654321"
      customer_info:
        type: object
        properties:
          customer_code:
            type: string
            required: true
            example: "BUYER001"
          customer_full_name:
            type: string
            required: true
            example: "Jane Smith"
          email_id:
            type: string
            required: true
            example: "jane.smith@email.com"
          phone_number:
            type: string
            required: true
            example: "+1-555-123-4567"
      transaction_details:
        type: object
        properties:
          transaction_date:
            type: datetime
            required: true
            example: "2024-01-15T14:45:00.000Z"
          gross_amount:
            type: number
            required: true
            example: 899.98
          transaction_currency:
            type: string
            required: true
            example: "USD"
          order_state:
            type: string
            enum: [RECEIVED, PROCESSING, FULFILLED, CLOSED, REJECTED]
            required: true
            example: "RECEIVED"
      product_lines:
        type: array
        items:
          type: object
          properties:
            line_number:
              type: string
              required: true
              example: "001"
            sku_code:
              type: string
              required: true
              example: "PROD001"
            product_name:
              type: string
              required: true
              example: "HP Laptop ProBook 450"
            ordered_qty:
              type: integer
              required: true
              example: 2
            list_price:
              type: number
              required: true
              example: 449.99
            product_type:
              type: string
              required: true
              example: "Computers"
      shipping_details:
        type: object
        properties:
          ship_to_address1:
            type: string
            required: true
            example: "456 Oak Avenue"
          ship_to_address2:
            type: string
            required: false
            example: "Suite 200"
          ship_to_city:
            type: string
            required: true
            example: "Seattle"
          ship_to_state:
            type: string
            required: true
            example: "WA"
          ship_to_zip:
            type: string
            required: true
            example: "98101"
          ship_to_country:
            type: string
            required: true
            example: "US"

  ProcessResponse:
    type: object
    properties:
      transactionId:
        type: string
        required: true
        example: "TXN_123456789"
      status:
        type: string
        enum: [SUCCESS, FAILURE, PARTIAL_SUCCESS]
        required: true
        example: "SUCCESS"
      message:
        type: string
        required: true
        example: "Order processed successfully"
      sourceOrderId:
        type: string
        required: true
        example: "FK123456789"
      targetOrderId:
        type: string
        required: false
        example: "IBM_FK123456789"
      processedAt:
        type: datetime
        required: true
        example: "2024-01-15T10:35:00.000Z"
      errors:
        type: array
        required: false
        items:
          type: object
          properties:
            errorCode:
              type: string
              example: "PROC_001"
            errorMessage:
              type: string
              example: "Validation error in customer details"
            field:
              type: string
              example: "customerInfo.email"

  ErrorResponse:
    type: object
    properties:
      errorCode:
        type: string
        required: true
        example: "PROC_001"
      errorMessage:
        type: string
        required: true
        example: "Invalid source system"
      timestamp:
        type: datetime
        required: true
        example: "2024-01-15T10:30:00Z"

/process:
  post:
    description: Process purchase order from source to target format
    body:
      application/json:
        type: ProcessOrderRequest
        examples:
          flipkart-to-ibm:
            source: "FLIPKART"
            target: "IBM"
            orderId: "FK123456789"
            orderData:
              orderId: "FK123456789"
              customerInfo:
                customerId: "CUST001"
                customerName: "John Doe"
                email: "john.doe@email.com"
                phone: "+91-9876543210"
              orderDetails:
                orderDate: "2024-01-15T10:30:00Z"
                totalAmount: 45000.00
                currency: "INR"
                status: "CONFIRMED"
              items:
                - itemId: "ITEM001"
                  productName: "Laptop Dell Inspiron"
                  quantity: 1
                  unitPrice: 45000.00
                  category: "Electronics"
              shippingAddress:
                addressLine1: "123 Main Street"
                city: "Bangalore"
                state: "Karnataka"
                postalCode: "560001"
                country: "India"
          amazon-to-hp:
            source: "AMAZON"
            target: "HP"
            orderId: "AMZ987654321"
            orderData:
              orderNumber: "AMZ987654321"
              buyerInfo:
                buyerId: "BUYER001"
                fullName: "Jane Smith"
                emailAddress: "jane.smith@email.com"
                phoneNumber: "+1-555-123-4567"
              purchaseInfo:
                purchaseDate: "2024-01-15T14:45:00Z"
                grandTotal: 899.98
                currencyCode: "USD"
                orderStatus: "PROCESSING"
              productList:
                - productId: "PROD001"
                  title: "HP Laptop ProBook 450"
                  qty: 2
                  price: 449.99
                  productCategory: "Computers"
              deliveryAddress:
                street: "456 Oak Avenue"
                cityName: "Seattle"
                stateCode: "WA"
                zipCode: "98101"
                countryCode: "US"
    responses:
      200:
        body:
          application/json:
            type: ProcessResponse
            examples:
              success-response:
                transactionId: "TXN_123456789"
                status: "SUCCESS"
                message: "Order processed successfully"
                sourceOrderId: "FK123456789"
                targetOrderId: "IBM_FK123456789"
                processedAt: "2024-01-15T10:35:00.000Z"
      400:
        body:
          application/json:
            type: ErrorResponse
      422:
        body:
          application/json:
            type: ErrorResponse
      500:
        body:
          application/json:
            type: ErrorResponse

/process/{transactionId}:
  get:
    description: Get processing status by transaction ID
    responses:
      200:
        body:
          application/json:
            type: ProcessResponse
      404:
        body:
          application/json:
            type: ErrorResponse
      500:
        body:
          application/json:
            type: ErrorResponse

/health:
  get:
    description: Health check endpoint
    responses:
      200:
        body:
          application/json:
            example: |
              {
                "status": "UP",
                "timestamp": "2024-01-15T10:30:00Z"
              }
